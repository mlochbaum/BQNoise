# Fast Fourier transform
# Argument has shape âŸ¨lâŸ© for real values or âŸ¨2,lâŸ© for complex, lâ†2â‹†n
# Result is complex encoded as shape âŸ¨2,lâŸ©.

Sinâ€¿Cos â† â€¢math

{
  ğ•¨ğ•Šâ¼ğ•©: (-ğ•¨1âŠ˜â‰¢Â¯1)ğ•Šğ•© ;

  inv â† ğ•¨â‰¡Â¯1
  "FFT argument must be a list or have two list cells" ! (3âŒŠ=)â—¶âŸ¨0,1,2=â‰ ,0âŸ©ğ•©
  n â† 2 â‹†â¼ l â† Â¯1âŠ‘â‰¢ğ•©
  "FFT length must be a power of two" ! âŒŠâŠ¸=n
  s â† 2 â¥ŠËœ n

  r â† (Cosâ‹ˆSin) Ï€ Ã— (1â†“s) â¥Š -âŸinv â†•âŠ¸Ã· lÃ·2   # Roots of unity
  M â† -Â´âˆ˜Ã— â‹ˆ +Â´âˆ˜Ã—âŸœâŒ½                         # Complex multiplication
  F â† { (r (2â€¿0<âŠ¸Â«ğ•¨â¥Š1)âŠ¸/Â¨â†©) âŠ¢ (+ËÂ¨(ğ•¨â‰â‰)Â¨r M-ËÂ¨)ğ•© } # FFT loop
  Ã·âŸœlâŸinv >â¥ŠÂ¨ (â†•n) FÂ´Ëœ sâŠ¸â¥ŠÂ¨ (1==)â—¶âŸ¨<Ë˜,âŠ¢â‹ˆ0Â¨âŸ© ğ•©
}
